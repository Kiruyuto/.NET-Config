<Project>
  <PropertyGroup Condition="'$(GITHUB_ACTIONS)' == 'true'">
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
  </PropertyGroup>

  <Target Name="PrintContinuousIntegrationMessage" BeforeTargets="Build" Condition="'$(GITHUB_ACTIONS)' == 'true'">
    <Message Text="'ContinuousIntegrationBuild' is set to '$(ContinuousIntegrationBuild)'" Importance="high" />
  </Target>

  <PropertyGroup>
    <!-- https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/errors-warnings#reportanalyzer -->
    <ReportAnalyzer>true</ReportAnalyzer>

    <!-- https://github.com/dotnet/runtime/issues/27005#issuecomment-408646070 -->
    <Features>strict</Features>

    <!-- https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/code-generation#deterministic -->
    <Deterministic>true</Deterministic>

    <!-- https://learn.microsoft.com/en-us/visualstudio/code-quality/install-net-analyzers -->
    <EnableNETAnalyzers>true</EnableNETAnalyzers>

    <!-- https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/overview?tabs=net-9#enable-additional-rules -->
    <AnalysisMode>All</AnalysisMode>
    <AnalysisLevel>preview</AnalysisLevel>

    <!-- https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/overview?tabs=net-9#treat-warnings-as-errors -->
    <TreatWarningsAsErrors Condition="'$(ContinuousIntegrationBuild)' == 'true'">true</TreatWarningsAsErrors>
    <CodeAnalysisTreatWarningsAsErrors Condition="'$(ContinuousIntegrationBuild)' == 'true'">true</CodeAnalysisTreatWarningsAsErrors>

    <!-- https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/overview?tabs=net-9#enable-on-build -->
    <EnforceCodeStyleInBuild Condition="'$(ContinuousIntegrationBuild)' == 'true'">true</EnforceCodeStyleInBuild>

    <GenerateDocumentationFile>true</GenerateDocumentationFile>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)' == 'Release'">
    <Optimize>true</Optimize>
  </PropertyGroup>
</Project>